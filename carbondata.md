# CarbonData

华为宣布开源的[CarbonData项目](https://github.com/apache/incubator-carbondata)于2016年6月3日通过Apache社区投票，成功进入Apache孵化器。CarbonData是一种低时延查询、存储和计算分离的轻量化文件存储格式。

针对数据的需求分析主要有以下5点要求：

1. 支持海量数据扫描并取其中几列；
2. 支持根据主键进行查找，并在压秒级响应；
3. 支持在海量数据进行类似于OLAP的交互式查询，并且查询中涉及到许多过滤条件，这种类型的workload应该在几秒钟内响应；
4. 支持快速地抽取单独的记录，并且从该记录中获取到所有列信息；
5. 支持HDFS，这样客户可以利用现有的Hadoop集群。

目前现有的Hadoop生态系统中没有同时满足这五点要求文件格式。比如Parquet/ORC的文件仅仅满足第一和第五条要求，而其他的要求无法满足，所以基于这些事实华为开始开发CarbonData。
  
CarbonData文件格式是基于列式存储的，并存储在HDFS之上；其包含了现有列式存储文件格式的许多有点，比如：可分割、可压缩、支持复杂数据类型等；并且CarbonData为了解决上面5点要求，加入了许多独特的特性，主要概括为以下四点：

1. 存储数据及其索引：在有过滤的查询中，它可以显著地加速查询性能，减少I/O和CPU资源。CarbonData的索引由多级索引组成，处理框架可以利用这些索引信息来减少调度和一些处理的开销；在任务扫描数据的时候它可以仅仅扫描更细粒度的单元(称为blocklet)，而不需要扫描整个文件。
2. 可操作的编码数据：通过支持高效的压缩和全局编码模式，它可以直接在压缩或者编码的数据上查询，仅仅在需要返回结果的时候才进行转换，这种技术被称为late materialized。
3. 列组：支持多列组成一个列组，并且使用行格式进行存储，这减少了查询时行重建的开销。
4. 支持多种使用场景：比如支持类OLAP风格的交互式查询、顺序存取、随机访问等。

 
Carbondata的列式文件格式与Parquet非常类似，OLAP借鉴了[Mondrian](http://community.pentaho.com/projects/mondrian/)。

由于在load数据时需要两次扫描，因此Carbondata加载的性能很差。


